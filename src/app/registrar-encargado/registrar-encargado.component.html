<!-- src/app/registrar-encargado/registrar-encargado.component.html -->

<div class="pagina">
  <!-- üîù Bot√≥n para cambiar de organizaci√≥n deportiva -->
  <div class="nav-buttons">
    <button type="button" class="secundario" (click)="irAOrganizacion()">
      Cambiar de Organizaci√≥n Deportiva
    </button>
  </div>

  <!-- üßæ Contenedor del formulario -->
  <div class="form-container">
    <h2>Registrar Encargado</h2>

    <form #encargadoForm="ngForm" (ngSubmit)="registrarEncargado(encargadoForm)">

      <!-- ‚Äî‚Äî NOMBRE ‚Äî‚Äî -->
      <label for="nombre">Nombre completo</label>
      <input
        id="nombre"
        name="nombre"
        type="text"
        [(ngModel)]="encargado.nombre"
        required
        minlength="2"
        maxlength="100"
        placeholder="Solo letras y espacios"
        #nombre="ngModel"
        (keypress)="soloLetrasKeypress($event)"
        (paste)="soloLetrasPaste($event)"
      />
      <div *ngIf="encargadoForm.submitted && nombre.invalid" class="error">
        El nombre es obligatorio y s√≥lo puede contener letras y espacios (2‚Äì100 caracteres).
      </div>

      <!-- ‚Äî‚Äî USERNAME ‚Äî‚Äî -->
      <label for="username">Username</label>
      <input
        id="username"
        name="username"
        type="text"
        [(ngModel)]="encargado.username"
        required
        minlength="5"
        maxlength="30"
        placeholder="Letras, n√∫meros, . y _"
        #username="ngModel"
        (keypress)="validarUsernameKeypress($event)"
        (paste)="bloquearPasteUsername($event)"
      />
      <div *ngIf="encargadoForm.submitted && username.invalid" class="error">
        El username es obligatorio (5‚Äì30 caracteres) y solo puede contener letras, n√∫meros, puntos o gui√≥n bajo,
        sin espacios al inicio/final ni ‚Äú..‚Äù/‚Äú__‚Äù.
      </div>

      <!-- ‚Äî‚Äî CONTRASE√ëA ‚Äî‚Äî -->
      <label for="contrasena">Contrase√±a</label>
      <div class="input-group">
        <input
          id="contrasena"
          name="contrasena"
          [type]="showPassword ? 'text' : 'password'"
          [(ngModel)]="encargado.contrasena"
          required
          minlength="8"
          maxlength="24"
          placeholder="Entre 8 y 24 caracteres (espacios cuentan)"
          #contrasena="ngModel"
        />
        <button
          type="button"
          class="eye-btn"
          (click)="togglePassword()"
          tabindex="-1"
          aria-label="Mostrar u ocultar contrase√±a"
        >
          <fa-icon [icon]="showPassword ? faEyeSlash : faEye"></fa-icon>
        </button>
      </div>
      <div *ngIf="encargadoForm.submitted && contrasena.invalid" class="error">
        La contrase√±a es obligatoria y debe tener entre 8 y 24 caracteres (los espacios cuentan).
      </div>

      <!-- ‚Äî‚Äî CONFIRMAR CONTRASE√ëA ‚Äî‚Äî -->
      <label for="confirmarContrasena">Confirmar Contrase√±a</label>
      <div class="input-group">
        <input
          id="confirmarContrasena"
          name="confirmarContrasena"
          [type]="showConfirmPassword ? 'text' : 'password'"
          [(ngModel)]="encargado.confirmarContrasena"
          required
          minlength="8"
          maxlength="24"
          placeholder="Repite la contrase√±a"
          #confirmarContrasena="ngModel"
        />
        <button
          type="button"
          class="eye-btn"
          (click)="toggleConfirmPassword()"
          tabindex="-1"
          aria-label="Mostrar u ocultar confirmaci√≥n"
        >
          <fa-icon [icon]="showConfirmPassword ? faEyeSlash : faEye"></fa-icon>
        </button>
      </div>
      <div *ngIf="encargadoForm.submitted && !contrasenasCoinciden()" class="error">
        Las contrase√±as no coinciden.
      </div>

      <!-- ‚Äî‚Äî TIPO DE DOCUMENTO ‚Äî‚Äî -->
      <label for="tipoDocumento">Tipo de Documento</label>
      <select
        id="tipoDocumento"
        name="tipoDocumento"
        [(ngModel)]="encargado.tipoDocumento"
        required
        #tipoDocumento="ngModel"
      >
        <option value="" disabled selected>Selecciona tipo de documento</option>
        <option value="CC">CC</option>
        <option value="CE">CE</option>
      </select>
      <div *ngIf="encargadoForm.submitted && tipoDocumento.invalid" class="error">
        Selecciona ‚ÄúCC‚Äù o ‚ÄúCE‚Äù.
      </div>

      <!-- ‚Äî‚Äî N√öMERO DE DOCUMENTO ‚Äî‚Äî -->
      <label for="numeroDocumento">N√∫mero de Documento</label>
      <input
        id="numeroDocumento"
        name="numeroDocumento"
        type="text"
        [(ngModel)]="encargado.numeroDocumento"
        required
        minlength="6"
        maxlength="10"
        placeholder="Solo d√≠gitos, sin espacios"
        #numeroDocumento="ngModel"
        (keypress)="soloNumerosKeypress($event)"
        (paste)="soloNumerosPaste($event)"
      />
      <div *ngIf="encargadoForm.submitted && numeroDocumento.invalid" class="error">
        El n√∫mero de documento es obligatorio y debe tener entre 6 y 10 d√≠gitos.
      </div>

      <!-- ‚Äî‚Äî PREFIJO TEL√âFONO ‚Äî‚Äî -->
      <label for="prefijoTelefono">Prefijo Telef√≥nico</label>
      <input
        id="prefijoTelefono"
        name="prefijoTelefono"
        type="text"
        [(ngModel)]="encargado.prefijoTelefono"
        required
        minlength="2"
        maxlength="5"
        placeholder="+57"
        #prefijoTelefono="ngModel"
        (keypress)="validarPrefijoKeypress($event)"
        (paste)="bloquearPastePrefijo($event)"
      />
      <div *ngIf="encargadoForm.submitted && prefijoTelefono.invalid" class="error">
        El prefijo es obligatorio y solo acepta ‚Äú+57‚Äù.
      </div>

      <!-- ‚Äî‚Äî TEL√âFONO ‚Äî‚Äî -->
      <label for="telefono">Tel√©fono</label>
      <input
        id="telefono"
        name="telefono"
        type="text"
        [(ngModel)]="encargado.telefono"
        required
        minlength="10"
        maxlength="10"
        placeholder="10 d√≠gitos, empieza con 3"
        #telefono="ngModel"
        (keypress)="validarTelefonoKeypress($event)"
        (paste)="bloquearPasteTelefono($event)"
      />
      <div *ngIf="encargadoForm.submitted && telefono.invalid" class="error">
        El tel√©fono es obligatorio, debe tener 10 d√≠gitos y empezar con 3.
      </div>

      <!-- ‚Äî‚Äî BOT√ìN DE ENV√çO ‚Äî‚Äî -->
      <button type="submit" [disabled]="cargando">
        {{ cargando ? 'Registrando...' : 'Registrar' }}
      </button>
    </form>

    <!-- üîÅ Estado y mensajes -->
    <div *ngIf="cargando" class="mensaje cargando">‚è≥ Registrando...</div>

    <div
      *ngIf="mensaje && !cargando"
      class="mensaje"
      [ngClass]="{
        'mensaje-exito': mensajeTipo === 'exito',
        'mensaje-error': mensajeTipo === 'error'
      }"
    >
      {{ mensaje }}
    </div>
  </div>
</div>
